<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Simple Cryptosystems</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-5">
  <h2 class="text-center mb-4">Simple Cryptosystems</h2>

  <!-- Flash messages -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }}">{{ message }}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <form method="POST" action="/" class="card p-4">
    <div class="mb-3">
      <label class="form-label">Input Text</label>
      <textarea class="form-control" name="input_text" rows="5"></textarea>
    </div>

    <div class="mb-3">
      <label class="form-label">Cipher</label>
      <select class="form-select" name="cipher">
        <option value="shift">Shift Cipher</option>
        <option value="sub">Substitution Cipher</option>
        <option value="affine">Affine Cipher</option>
        <option value="vig">Vigenère Cipher</option>
        <option value="hill">Hill Cipher</option>
        <option value="perm">Permutation Cipher</option>
      </select>
    </div>

    <!-- Keys -->
    <div class="mb-3">
      <input class="form-control mb-2" type="text" name="shift_key" placeholder="Shift key (0-25)">
      <input class="form-control mb-2" type="text" name="sub_key" placeholder="Substitution Key (26 letters)">
      <input class="form-control mb-2" type="text" name="a" placeholder="Affine a">
      <input class="form-control mb-2" type="text" name="b" placeholder="Affine b">
      <input class="form-control mb-2" type="text" name="vig_key" placeholder="Vigenère keyword">
      <input class="form-control mb-2" type="text" name="m00" placeholder="Hill m00">
      <input class="form-control mb-2" type="text" name="m01" placeholder="Hill m01">
      <input class="form-control mb-2" type="text" name="m10" placeholder="Hill m10">
      <input class="form-control mb-2" type="text" name="m11" placeholder="Hill m11">
      <input class="form-control mb-2" type="text" name="perm_key" placeholder="Permutation key (e.g. '3 1 4 2')">
    </div>

    <div class="mb-3">
      <label class="form-label">Output Format</label><br>
      <input type="radio" name="format" value="normal" checked> Normal
      <input type="radio" name="format" value="nospace"> No Spaces
      <input type="radio" name="format" value="groups"> 5-Letter Groups
    </div>

    <div class="mb-3">
      <button class="btn btn-primary" type="submit" name="action" value="Encrypt">Encrypt</button>
      <button class="btn btn-success" type="submit" name="action" value="Decrypt">Decrypt</button>
    </div>
  </form>

  <!-- Output -->
  {% if output %}
  <div class="card mt-4 p-4">
    <h5>Output:</h5>
    <textarea class="form-control" rows="6" readonly>{{ output }}</textarea>
    <form method="POST" action="{{ url_for('save') }}">
      <input type="hidden" name="output" value="{{ output }}">
      <button type="submit" class="btn btn-secondary mt-2">Download as file</button>
    </form>
  </div>
  {% endif %}
</div>

</body>
</html>
