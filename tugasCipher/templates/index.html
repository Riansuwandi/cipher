<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Simple Cryptosystems</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<div class="container py-5">
  <h2 class="text-center mb-4">Simple Cryptosystems</h2>

  <!-- Flash Messages -->
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
        <div class="alert alert-{{ category }}">{{ message }}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}

  <!-- Tabs -->
  <ul class="nav nav-tabs" id="cipherTabs" role="tablist">
    <li class="nav-item"><a class="nav-link active" data-bs-toggle="tab" href="#shift">Shift</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#sub">Substitution</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#affine">Affine</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#vig">Vigen√®re</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#hill">Hill</a></li>
    <li class="nav-item"><a class="nav-link" data-bs-toggle="tab" href="#perm">Permutation</a></li>
  </ul>

  <div class="tab-content card p-4">
    <!-- Shift -->
    <div class="tab-pane fade show active" id="shift">
      <form method="POST" enctype="multipart/form-data">
        <input type="hidden" name="cipher" value="shift">
        <div class="mb-3">
          <label class="form-label">Input Text / Upload File</label>
          <textarea class="form-control" name="input_text" rows="3"></textarea>
          <input type="file" class="form-control mt-2" name="file_input">
        </div>
        <div class="mb-3">
          <label class="form-label">Shift Key (0-25)</label>
          <input type="number" class="form-control" name="shift_key" placeholder="e.g. 3">
        </div>
        <div class="mb-3">
          <label class="form-label">Output Format</label><br>
          <input type="radio" name="format" value="normal" checked> Normal
          <input type="radio" name="format" value="nospace"> No Spaces
          <input type="radio" name="format" value="groups"> 5-Letter Groups
        </div>
        <div class="mb-3">
          <button class="btn btn-primary" type="submit" name="action" value="Encrypt">Encrypt</button>
          <button class="btn btn-success" type="submit" name="action" value="Decrypt">Decrypt</button>
        </div>
      </form>
    </div>

    <!-- Substitution -->
    <div class="tab-pane fade" id="sub">
      <form method="POST" enctype="multipart/form-data">
        <input type="hidden" name="cipher" value="sub">
        <div class="mb-3">
          <label class="form-label">Input Text / Upload File</label>
          <textarea class="form-control" name="input_text" rows="3"></textarea>
          <input type="file" class="form-control mt-2" name="file_input">
        </div>
        <div class="mb-3">
          <label class="form-label">Substitution Key (26 letters)</label>
          <input type="text" class="form-control" name="sub_key" placeholder="ZYXWVUTSRQPONMLKJIHGFEDCBA">
        </div>
        <div class="mb-3">
          <label class="form-label">Output Format</label><br>
          <input type="radio" name="format" value="normal" checked> Normal
          <input type="radio" name="format" value="nospace"> No Spaces
          <input type="radio" name="format" value="groups"> 5-Letter Groups
        </div>
        <div class="mb-3">
          <button class="btn btn-primary" type="submit" name="action" value="Encrypt">Encrypt</button>
          <button class="btn btn-success" type="submit" name="action" value="Decrypt">Decrypt</button>
        </div>
      </form>
    </div>

    <!-- Affine -->
    <div class="tab-pane fade" id="affine">
      <form method="POST" enctype="multipart/form-data">
        <input type="hidden" name="cipher" value="affine">
        <div class="mb-3">
          <label class="form-label">Input Text / Upload File</label>
          <textarea class="form-control" name="input_text" rows="3"></textarea>
          <input type="file" class="form-control mt-2" name="file_input">
        </div>
        <div class="row">
          <div class="col">
            <label class="form-label">a (coprime with 26)</label>
            <input type="number" class="form-control" name="a" placeholder="e.g. 5">
          </div>
          <div class="col">
            <label class="form-label">b (0-25)</label>
            <input type="number" class="form-control" name="b" placeholder="e.g. 8">
          </div>
        </div>
        <div class="mb-3 mt-3">
          <label class="form-label">Output Format</label><br>
          <input type="radio" name="format" value="normal" checked> Normal
          <input type="radio" name="format" value="nospace"> No Spaces
          <input type="radio" name="format" value="groups"> 5-Letter Groups
        </div>
        <div class="mb-3">
          <button class="btn btn-primary" type="submit" name="action" value="Encrypt">Encrypt</button>
          <button class="btn btn-success" type="submit" name="action" value="Decrypt">Decrypt</button>
        </div>
      </form>
    </div>

    <!-- Vigenere -->
    <div class="tab-pane fade" id="vig">
      <form method="POST" enctype="multipart/form-data">
        <input type="hidden" name="cipher" value="vig">
        <div class="mb-3">
          <label class="form-label">Input Text / Upload File</label>
          <textarea class="form-control" name="input_text" rows="3"></textarea>
          <input type="file" class="form-control mt-2" name="file_input">
        </div>
        <div class="mb-3">
          <label class="form-label">Keyword</label>
          <input type="text" class="form-control" name="vig_key" placeholder="e.g. CRYPTO">
        </div>
        <div class="mb-3">
          <label class="form-label">Output Format</label><br>
          <input type="radio" name="format" value="normal" checked> Normal
          <input type="radio" name="format" value="nospace"> No Spaces
          <input type="radio" name="format" value="groups"> 5-Letter Groups
        </div>
        <div class="mb-3">
          <button class="btn btn-primary" type="submit" name="action" value="Encrypt">Encrypt</button>
          <button class="btn btn-success" type="submit" name="action" value="Decrypt">Decrypt</button>
        </div>
      </form>
    </div>

    <!-- Hill -->
    <div class="tab-pane fade" id="hill">
      <form method="POST" enctype="multipart/form-data">
        <input type="hidden" name="cipher" value="hill">
        <div class="mb-3">
          <label class="form-label">Input Text / Upload File</label>
          <textarea class="form-control" name="input_text" rows="3"></textarea>
          <input type="file" class="form-control mt-2" name="file_input">
        </div>
        <div class="row">
          <div class="col"><input type="number" class="form-control" name="m00" placeholder="m00"></div>
          <div class="col"><input type="number" class="form-control" name="m01" placeholder="m01"></div>
        </div>
        <div class="row mt-2">
          <div class="col"><input type="number" class="form-control" name="m10" placeholder="m10"></div>
          <div class="col"><input type="number" class="form-control" name="m11" placeholder="m11"></div>
        </div>
        <div class="mb-3 mt-3">
          <label class="form-label">Output Format</label><br>
          <input type="radio" name="format" value="normal" checked> Normal
          <input type="radio" name="format" value="nospace"> No Spaces
          <input type="radio" name="format" value="groups"> 5-Letter Groups
        </div>
        <div class="mb-3">
          <button class="btn btn-primary" type="submit" name="action" value="Encrypt">Encrypt</button>
          <button class="btn btn-success" type="submit" name="action" value="Decrypt">Decrypt</button>
        </div>
      </form>
    </div>

    <!-- Permutation -->
    <div class="tab-pane fade" id="perm">
      <form method="POST" enctype="multipart/form-data">
        <input type="hidden" name="cipher" value="perm">
        <div class="mb-3">
          <label class="form-label">Input Text / Upload File</label>
          <textarea class="form-control" name="input_text" rows="3"></textarea>
          <input type="file" class="form-control mt-2" name="file_input">
        </div>
        <div class="mb-3">
          <label class="form-label">Permutation Key (space-separated numbers)</label>
          <input type="text" class="form-control" name="perm_key" placeholder="e.g. 3 1 4 2">
        </div>
        <div class="mb-3">
          <label class="form-label">Output Format</label><br>
          <input type="radio" name="format" value="normal" checked> Normal
          <input type="radio" name="format" value="nospace"> No Spaces
          <input type="radio" name="format" value="groups"> 5-Letter Groups
        </div>
        <div class="mb-3">
          <button class="btn btn-primary" type="submit" name="action" value="Encrypt">Encrypt</button>
          <button class="btn btn-success" type="submit" name="action" value="Decrypt">Decrypt</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Playfair -->
  <div class="tab-pane fade" id="playfair">
    <form method="POST" enctype="multipart/form-data">
      <input type="hidden" name="cipher" value="playfair">
      <div class="mb-3">
        <label class="form-label">Input Text / Upload File</label>
        <textarea class="form-control" name="input_text" rows="3"></textarea>
        <input type="file" class="form-control mt-2" name="file_input">
      </div>
      <div class="mb-3">
        <label class="form-label">Keyword (untuk 5x5 grid)</label>
        <input type="text" class="form-control" name="playfair_key" placeholder="contoh: MONARCHY">
      </div>
      <div class="mb-3">
        <label class="form-label">Output Format</label><br>
        <input type="radio" name="format" value="normal" checked> Normal
        <input type="radio" name="format" value="nospace"> No Spaces
        <input type="radio" name="format" value="groups"> 5-Letter Groups
      </div>
      <div class="mb-3">
        <button class="btn btn-primary" type="submit" name="action" value="Encrypt">Encrypt</button>
        <button class="btn btn-success" type="submit" name="action" value="Decrypt">Decrypt</button>
      </div>
    </form>
  </div>

  <!-- One-Time Pad -->
  <div class="tab-pane fade" id="otp">
    <form method="POST" enctype="multipart/form-data">
      <input type="hidden" name="cipher" value="otp">
      <div class="mb-3">
        <label class="form-label">Input Text / Upload File</label>
        <textarea class="form-control" name="input_text" rows="3"></textarea>
        <input type="file" class="form-control mt-2" name="file_input">
      </div>
      <div class="mb-3">
        <label class="form-label">Upload Key File (berisi huruf acak A-Z)</label>
        <input type="file" class="form-control" name="key_file" required>
      </div>
      <div class="mb-3">
        <label class="form-label">Output Format</label><br>
        <input type="radio" name="format" value="normal" checked> Normal
        <input type="radio" name="format" value="nospace"> No Spaces
        <input type="radio" name="format" value="groups"> 5-Letter Groups
      </div>
      <div class="mb-3">
        <button class="btn btn-primary" type="submit" name="action" value="Encrypt">Encrypt</button>
        <button class="btn btn-success" type="submit" name="action" value="Decrypt">Decrypt</button>
      </div>
    </form>
  </div>

  <!-- Output Section -->
  {% if output %}
  <div class="card mt-4 p-4">
    <h5>Hasil:</h5>
    <textarea class="form-control" rows="6" readonly>{{ output }}</textarea>
    <form method="POST" action="{{ url_for('save') }}">
      <input type="hidden" name="output" value="{{ output }}">
      <button type="submit" class="btn btn-secondary mt-2">Download as file</button>
    </form>
  </div>
  {% endif %}
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
